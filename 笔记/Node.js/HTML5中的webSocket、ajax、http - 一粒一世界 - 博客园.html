<!DOCTYPE html>
<!-- saved from url=(0046)https://www.cnblogs.com/leftJS/p/11041346.html -->
<html lang="zh-cn"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="referrer" content="never">
    <meta property="og:description" content="本文原链接：https://cloud.tencent.com/developer/article/1115496 https://cloud.tencent.com/developer/articl">
    <meta http-equiv="Cache-Control" content="no-transform">
    <meta http-equiv="Cache-Control" content="no-siteapp">
    <title>HTML5中的webSocket、ajax、http - 一粒一世界 - 博客园</title>
    
    <link rel="stylesheet" href="./HTML5中的webSocket、ajax、http - 一粒一世界 - 博客园_files/blog-common.min.css">
    <link id="MainCss" rel="stylesheet" href="./HTML5中的webSocket、ajax、http - 一粒一世界 - 博客园_files/bundle-codinglife.min.css">
    
    <link id="mobile-style" media="only screen and (max-width: 767px)" type="text/css" rel="stylesheet" href="./HTML5中的webSocket、ajax、http - 一粒一世界 - 博客园_files/bundle-codinglife-mobile.min.css">
    
    <link type="application/rss+xml" rel="alternate" href="https://www.cnblogs.com/leftJS/rss">
    <link type="application/rsd+xml" rel="EditURI" href="https://www.cnblogs.com/leftJS/rsd.xml">
    <link type="application/wlwmanifest+xml" rel="wlwmanifest" href="https://www.cnblogs.com/leftJS/wlwmanifest.xml">
    <script src="./HTML5中的webSocket、ajax、http - 一粒一世界 - 博客园_files/amp4ads-host-v0.js.下载"></script><script src="./HTML5中的webSocket、ajax、http - 一粒一世界 - 博客园_files/pubads_impl_rendering_2019111201.js.下载"></script><script async="" src="./HTML5中的webSocket、ajax、http - 一粒一世界 - 博客园_files/analytics.js.下载"></script><script src="./HTML5中的webSocket、ajax、http - 一粒一世界 - 博客园_files/jquery-2.2.0.min.js.下载"></script>
    <script src="./HTML5中的webSocket、ajax、http - 一粒一世界 - 博客园_files/blog-common.min.js.下载"></script>
    <script>
        var currentBlogId = 489310;
        var currentBlogApp = 'leftJS';
        var cb_enable_mathjax = false;
        var isLogined = false;
    </script>
    
    
    
<link rel="preload" href="./HTML5中的webSocket、ajax、http - 一粒一世界 - 博客园_files/f.txt" as="script"><script type="text/javascript" src="./HTML5中的webSocket、ajax、http - 一粒一世界 - 博客园_files/f.txt"></script><script src="./HTML5中的webSocket、ajax、http - 一粒一世界 - 博客园_files/pubads_impl_2019111201.js.下载" async=""></script><link rel="prefetch" href="https://tpc.googlesyndication.com/safeframe/1-0-36/html/container.html"></head>
<body>
    <a name="top"></a>
    
    
<!--done-->
<div id="home">
<div id="header">
	<div id="blogTitle">
        <a id="lnkBlogLogo" href="https://www.cnblogs.com/leftJS/"><img id="blogLogo" src="./HTML5中的webSocket、ajax、http - 一粒一世界 - 博客园_files/logo.gif" alt="返回主页"></a>		
		
<!--done-->
<h1><a id="Header1_HeaderTitle" class="headermaintitle HeaderMainTitle" href="https://www.cnblogs.com/leftJS/">一粒一世界</a>
</h1>
<h2>

</h2>




		
	</div><!--end: blogTitle 博客的标题和副标题 -->
	<div id="navigator">
		
<ul id="navList">
<li><a id="blog_nav_sitehome" class="menu" href="https://www.cnblogs.com/">
博客园</a>
</li>
<li>
<a id="blog_nav_myhome" class="menu" href="https://www.cnblogs.com/leftJS/">
首页</a>
</li>
<li>

<a id="blog_nav_newpost" class="menu" href="https://i.cnblogs.com/EditPosts.aspx?opt=1">
新随笔</a>
</li>
<li>
<a id="blog_nav_contact" class="menu" href="https://msg.cnblogs.com/send/%E4%B8%80%E7%B2%92%E4%B8%80%E4%B8%96%E7%95%8C">
联系</a></li>
<li>
<a id="blog_nav_rss" class="menu" href="https://www.cnblogs.com/leftJS/rss/">
订阅</a>
<!--<partial name="./Shared/_XmlLink.cshtml" model="Model" /></li>--></li>
<li>
<a id="blog_nav_admin" class="menu" href="https://i.cnblogs.com/">
管理</a>
</li>
</ul>


		<div class="blogStats">
			
			<span id="stats_post_count">随笔 - 
88&nbsp; </span>
<span id="stats_article_count">文章 - 
0&nbsp; </span>
<span id="stats-comment_count">评论 - 
0</span>

			
		</div><!--end: blogStats -->
	</div><!--end: navigator 博客导航栏 -->
</div><!--end: header 头部 -->

<div id="main">
	<div id="mainContent">
	<div class="forFlow">
		<div id="post_detail">
    <!--done-->
    <div id="topics">
        <div class="post">
            <h1 class="postTitle">
                
<a id="cb_post_title_url" class="postTitle2" href="https://www.cnblogs.com/leftJS/p/11041346.html">HTML5中的webSocket、ajax、http</a>

            </h1>
            <div class="clear"></div>
            <div class="postBody">
                
<div id="cnblogs_post_body" class="blogpost-body ">
    <p>本文原链接：<a href="https://cloud.tencent.com/developer/article/1115496">https://cloud.tencent.com/developer/article/1115496</a></p>
<p><a href="https://cloud.tencent.com/developer/article/1193011">https://cloud.tencent.com/developer/article/1193011</a></p>
<h1 class="col-article-title J-articleTitle">webSocket与ajax、web</h1>
<div class="col-markdown-nav">
<ul class="col-markdown-nav-list">
<li><a title="一、webSocket与ajax" data-key="1.1">一、webSocket与ajax</a>
<ul>
<li><a title="1、ajax" data-key="2.1">1、ajax</a></li>
<li><a title="2、webSocket" data-key="2.3">2、webSocket</a></li>
</ul>
</li>
<li><a title="二、webSocket API" data-key="1.2">二、webSocket API</a>
<ul>
<li><a title="1、事件" data-key="2.5">1、事件</a></li>
<li><a title="2、方法" data-key="2.6">2、方法</a></li>
<li><a title="3、属性" data-key="2.8">3、属性</a></li>
<li><a title="4、常量" data-key="2.9">4、常量</a></li>
</ul>
</li>
<li><a title="三、webSocket与HTTP" data-key="1.3">三、webSocket与HTTP</a></li>
<li><a title="四、webSocket原理" data-key="1.4">四、webSocket原理</a></li>
<li><a title="五、webSocket的作用" data-key="1.5">五、webSocket的作用</a>
<ul>
<li><a title="1、ajax轮询：" data-key="2.10">1、ajax轮询：</a></li>
<li><a title="2、long poll" data-key="2.12">2、long poll</a></li>
<li><a title="3、webSocket" data-key="2.13">3、webSocket</a></li>
</ul>
</li>
<li><a title="六、Socket.io" data-key="1.6">六、Socket.io</a></li>
</ul>
</div>
<div class="c-markdown J-articleContent">
<p>先看一个有道释义：</p>
<div class="image-block"><img src="./HTML5中的webSocket、ajax、http - 一粒一世界 - 博客园_files/4e3rssrb94.png" alt=""></div>
<p>其实释义的挺形象的，下面我来一一解释哈：</p>
<p>1、聊天室：webSocket有名的应用就是聊天室了；</p>
<p>2、服务：webSocket提供客户端请求的服务器和服务；</p>
<p>3、套接字：源IP地址和目的IP地址以及源端口号和目的端口号的组合叫套接字，webSocket就是服务端和客户端的结合；</p>
<p>4、协议：webSocket是基于TCP的一种新的网络协议。</p>
<h1><strong>一、webSocket与ajax</strong></h1>
<p>作为一个码了还算久代码的前端，说起webSocket，脑子里最先闪现的当然就是ajax ajax ajax......ajax是啥，ajax刚出来时，可谓轰动一时，让我们愉快地告别那种提交一个表单必须得填完所有信息，然后再把数据转给服务器验证，结果发现有一个小小的输入框里输错了信息，然后又改掉重新提交走着重复的路的痛苦时代，所以它最大的贡献就是局部刷新。当然，不是说有了webSocket，它就out了，ajax现在依旧好用。下面稍微比较了下ajax和webSocket：</p>
<h2>1、ajax</h2>
<h4>（1）浏览器主动发送消息给服务器；</h4>
<h4>（2）非实时数据交互（异步，局部刷新）。</h4>
<div class="image-block"><img src="./HTML5中的webSocket、ajax、http - 一粒一世界 - 博客园_files/me757wg861.png" alt=""></div>
<p>原生写法：</p>
<p>四部曲：<strong>ajax对象、建立连接、发送请求、获取相应</strong>。</p>
<p>更通俗的用打电话来比喻，那就是：<strong>电话、拨号、说话、听到对方回应</strong>。<a href="https://jojojojo.duapp.com/websocket/ajax.html" rel="nofollow noopener noreferrer" target="_blank">demo</a></p>
<pre class="prism-token token  language-javascript"><span class="token comment">//创建一个ajax对象（想打电话，首先得有电话这个对象）<br></span></pre>
<pre class="prism-token token  language-javascript"><span class="token comment"><span class="token keyword">var XHR <span class="token operator">= <span class="token keyword">null<span class="token punctuation">;  
<span class="token keyword">if <span class="token punctuation">(window<span class="token punctuation">.XMLHttpRequest<span class="token punctuation">) <span class="token punctuation">{  
    <span class="token comment">// 非IE内核  
    XHR <span class="token operator">= <span class="token keyword">new <span class="token class-name">XMLHttpRequest<span class="token punctuation">(<span class="token punctuation">)<span class="token punctuation">;  
<span class="token punctuation">} <span class="token keyword">else <span class="token keyword">if <span class="token punctuation">(window<span class="token punctuation">.ActiveXObject<span class="token punctuation">) <span class="token punctuation">{  
    <span class="token comment">// IE内核,早期IE的版本写法不同
    XHR <span class="token operator">= <span class="token keyword">new <span class="token class-name">ActiveXObject<span class="token punctuation">(<span class="token string">"Microsoft.XMLHTTP"<span class="token punctuation">)<span class="token punctuation">;  
<span class="token punctuation">} <span class="token keyword">else <span class="token punctuation">{  
    XHR <span class="token operator">= <span class="token keyword">null<span class="token punctuation">;  
<span class="token punctuation">}  </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="token comment"><br></span></pre>
<pre class="prism-token token  language-javascript"><span class="token comment"><span class="token keyword"><span class="token operator"><span class="token keyword"><span class="token punctuation"><span class="token keyword"><span class="token punctuation"><span class="token punctuation"><span class="token punctuation"><span class="token punctuation"><span class="token comment"><span class="token operator"><span class="token keyword"><span class="token class-name"><span class="token punctuation"><span class="token punctuation"><span class="token punctuation"><span class="token punctuation"><span class="token keyword"><span class="token keyword"><span class="token punctuation"><span class="token punctuation"><span class="token punctuation"><span class="token punctuation"><span class="token comment"><span class="token operator"><span class="token keyword"><span class="token class-name"><span class="token punctuation"><span class="token string"><span class="token punctuation"><span class="token punctuation"><span class="token punctuation"><span class="token keyword"><span class="token punctuation"><span class="token operator"><span class="token keyword"><span class="token punctuation"><span class="token punctuation"><span class="token keyword">if<span class="token punctuation">(XHR<span class="token punctuation">)<span class="token punctuation">{  
    <span class="token comment">//建立连接（拨号）
    XHR<span class="token punctuation">.<span class="token function">open<span class="token punctuation">(<span class="token string">"GET"<span class="token punctuation">, <span class="token string">"ajaxServer.action"，true<span class="token punctuation">)<span class="token punctuation">;  

    <span class="token comment">//发送请求（说话）
    XHR<span class="token punctuation">.<span class="token function">send<span class="token punctuation">(<span class="token punctuation">)<span class="token punctuation">;  
    
    <span class="token comment">//获取响应（听到对方回应）
    XHR<span class="token punctuation">.<span class="token function-variable function">onreadystatechange <span class="token operator">= <span class="token keyword">function <span class="token punctuation">(<span class="token punctuation">) <span class="token punctuation">{  
        <span class="token comment">// readyState值说明  
        <span class="token comment">// 0,初始化,XHR对象已经创建,还未执行open  
        <span class="token comment">// 1,载入,已经调用open方法,但是还没发送请求  
        <span class="token comment">// 2,载入完成,请求已经发送完成  
        <span class="token comment">// 3,交互,可以接收到部分数据 <br>        // 4,交互完毕
  
        <span class="token comment">// status值说明  
        <span class="token comment">// 200:成功  
        <span class="token comment">// 404:没有发现文件、查询或URl  
        <span class="token comment">// 500:服务器产生内部错误  
        <span class="token keyword">if <span class="token punctuation">(XHR<span class="token punctuation">.readyState <span class="token operator">== <span class="token number">4 <span class="token operator">&amp;&amp; XHR<span class="token punctuation">.status <span class="token operator">== <span class="token number">200<span class="token punctuation">) <span class="token punctuation">{  
            <span class="token comment">// 这里可以对返回的内容做处理  
            <span class="token comment">// 一般会返回JSON或XML数据格式  
            console<span class="token punctuation">.<span class="token function">log<span class="token punctuation">(XHR<span class="token punctuation">.responseText<span class="token punctuation">)<span class="token punctuation">;  
            <span class="token comment">// 主动释放,JS本身也会回收的  
            XHR <span class="token operator">= <span class="token keyword">null<span class="token punctuation">;  
        <span class="token punctuation">}  
    <span class="token punctuation">}<span class="token punctuation">;  
<span class="token punctuation">}</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre>
<p>JQuery写法（so easy，妈妈再也不用担心我的学习啦）：</p>
<pre class="prism-token token  language-javascript">$<span class="token punctuation">.<span class="token function">ajax<span class="token punctuation">(<span class="token punctuation">{
    type<span class="token punctuation">:<span class="token string">"post"<span class="token punctuation">,
    url<span class="token punctuation">:url<span class="token punctuation">,
    <span class="token keyword">async<span class="token punctuation">:<span class="token boolean">true<span class="token punctuation">,
    data<span class="token punctuation">:params<span class="token punctuation">,
    dataType<span class="token punctuation">:<span class="token string">"json"<span class="token punctuation">,
    success<span class="token punctuation">:<span class="token keyword">function<span class="token punctuation">(res<span class="token punctuation">)<span class="token punctuation">{
        console<span class="token punctuation">.<span class="token function">log<span class="token punctuation">(res<span class="token punctuation">)<span class="token punctuation">;
    <span class="token punctuation">}<span class="token punctuation">,
    error<span class="token punctuation">:<span class="token keyword">function<span class="token punctuation">(jqXHQ<span class="token punctuation">)<span class="token punctuation">{
        <span class="token function">alert<span class="token punctuation">(<span class="token string">"发生错误:"<span class="token operator">+jqXHQ<span class="token punctuation">.status<span class="token punctuation">)<span class="token punctuation">;
    <span class="token punctuation">}
<span class="token punctuation">}<span class="token punctuation">)<span class="token punctuation">;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre>
<h2>&nbsp;</h2>
<h2>2、webSocket</h2>
<h4>（1）实现了浏览器与服务器全双工(full-duplex)通信——允许服务器主动发送信息给客户端；</h4>
<h4>（2）实时数据交互。</h4>
<div class="page" title="Page 2">
<div class="layoutArea">
<div class="column">
<p><strong>WebSocket 握手过程</strong><br>
WebSocket 协议本质上是一个基于 TCP 的协议，WebSocket
</p>
<p>连接与 TCP 连接的建立过程类似[4]。但与传统的基于 TCP 连
接的协议有所不同的是 WebSocket 协议需要从 HTTP 协议“过
渡”而来，而这个“过度”过程也被称为 WebSocket 协议的握手
过程。因此想要建立基于 WebSocket 的 Web 应用必须首先了解
WebSocket 协议的握手机制，如图 2 给出了 WebSocket 协议握手
过程的示意图。
</p>
<p>首先由浏览器客户端向服务器发起 WebSocket 握手请求报
文，这个报文是基于 HTTP 协议的，它告诉服务器客户端想要升
级当前的 HTTP 协议为 WebSocket 协议。服务器收到客户端的
WebSocket 握手请求报文之后会对报头进行解析，如果服务器
理解客户端握手请求报头并且满足升级为 WebSocket 协议的条
件，便会向客户端发送握手应答报文，这个应答报文同样是基于
HTTP 协议的。客户端收到服务器的应答报文后会对该报文进
行一次验证，验证成功之后便会成功升级为 WebSocket 协议，如
果验证失败客户端将会主动断开连接。建立了 WebSocket 连接
之后，双方便可以进行全双工通信，&nbsp;</p>
<div class="page" title="Page 2">
<div class="layoutArea">
<div class="column">
<p>WebSocket 握手过程与 TCP 握手过程类似，但是 WebSocket 协议握手采用了更加简洁的方式。<br>
</p>




				</div>




			</div>




		</div>
<div class="page" title="Page 2">
<div class="layoutArea">
<div class="column">
<p>相对于传统的 TCP 握手，WebSocket 握手协议有以下明显 的特点: 首先，WebSocket 整个握手过程只需要两次握手，相对 于 TCP 的三次握手，WebSocket 简化并且加入了自己的规则。 其次，WebSocket 握手协议是基于 HTTP 协议的，相对于字节流 的解析，ASCII 序列解析起来更加简便。最后，WebSocket 握手 协议引入了随机序列认证机制，易于实现。</p>
<p>两次握手成功预示着双方接下来将升级当前的 HTTP 协议 为 WebSocket 协议。WebSocket 握手请求报文的报头部分除了 必须包含必要的 HTTP 字段[5]，还须遵循通用消息格式[RFC 822]，同时又要包含和 WebSocket 紧密联系的字段[6]，如 Web- Socket 协议的版本信息、客户端随即生成的 Key、必要的 GET 请 求方法等。&nbsp;</p>


</div>


</div>


</div>




				</div>




			</div>




		</div>
<p>&nbsp;</p>
<div class="image-block"><img src="./HTML5中的webSocket、ajax、http - 一粒一世界 - 博客园_files/xx7u4h11yp.png" alt=""></div>
<pre class="prism-token token  language-javascript"><span class="token comment">// Create WebSocket connection.
<span class="token keyword">var socket <span class="token operator">= <span class="token keyword">new <span class="token class-name">WebSocket<span class="token punctuation">(<span class="token string">'ws://localhost:8080'<span class="token punctuation">)<span class="token punctuation">;    <span class="token comment">//创建一个webSocket实例

<span class="token comment">// Connection opened
socket<span class="token punctuation">.<span class="token function">addEventListener<span class="token punctuation">(<span class="token string">'open'<span class="token punctuation">, <span class="token keyword">function <span class="token punctuation">(event<span class="token punctuation">) <span class="token punctuation">{   <span class="token comment">//一旦服务端响应WebSocket连接请求，就会触发open事件
    socket<span class="token punctuation">.<span class="token function">send<span class="token punctuation">(<span class="token string">'Hello Server!'<span class="token punctuation">)<span class="token punctuation">;
<span class="token punctuation">}<span class="token punctuation">)<span class="token punctuation">;

<span class="token comment">// Listen for messages
socket<span class="token punctuation">.<span class="token function">addEventListener<span class="token punctuation">(<span class="token string">'message'<span class="token punctuation">, <span class="token keyword">function <span class="token punctuation">(event<span class="token punctuation">) <span class="token punctuation">{  <span class="token comment">//当消息被接受会触发消息事件
    console<span class="token punctuation">.<span class="token function">log<span class="token punctuation">(<span class="token string">'Message from server'<span class="token punctuation">, event<span class="token punctuation">.data<span class="token punctuation">)<span class="token punctuation">;
<span class="token punctuation">}<span class="token punctuation">)<span class="token punctuation">;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre>
<h2>&nbsp;</h2>
<h1>二、webSocket API</h1>
<p>既然上面写了一部分代码，那不如把API全都贴出来，哈哈哈。</p>
<p>首先，创建一个webSocket实例：</p>
<pre class="prism-token token  language-javascript"><span class="token keyword">var socket <span class="token operator">= <span class="token keyword">new <span class="token class-name">WebSocket<span class="token punctuation">(<span class="token string">'ws://localhost:8080'<span class="token punctuation">)<span class="token punctuation">;  </span></span></span></span></span></span></span></span></pre>
<p>然后再看下面的的API。</p>
<h2>1、事件</h2>
<h3><strong>（1）open</strong></h3>
<p>一个用于连接打开事件的事件监听器。当<code>readyState</code>的值变为 OPEN 的时候会触发该事件。该事件表明这个连接已经准备好接受和发送数据。这个监听器会接受一个名为"open"的事件对象。</p>
<pre class="prism-token token  language-javascript">socket<span class="token punctuation">.<span class="token function-variable function">onopen <span class="token operator">= <span class="token keyword">function<span class="token punctuation">(e<span class="token punctuation">) <span class="token punctuation">{
    console<span class="token punctuation">.<span class="token function">log<span class="token punctuation">(<span class="token string">"Connection open..."<span class="token punctuation">)<span class="token punctuation">;
<span class="token punctuation">}<span class="token punctuation">;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre>
<p>或者：</p>
<pre class="prism-token token  language-javascript">socket<span class="token punctuation">.<span class="token function">addEventListener<span class="token punctuation">(<span class="token string">'open'<span class="token punctuation">, <span class="token keyword">function <span class="token punctuation">(event<span class="token punctuation">) <span class="token punctuation">{
    console<span class="token punctuation">.<span class="token function">log<span class="token punctuation">(<span class="token string">"Connection open..."<span class="token punctuation">)<span class="token punctuation">;
<span class="token punctuation">}<span class="token punctuation">)<span class="token punctuation">;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre>
<h3>（2）message</h3>
<p>一个用于消息事件的事件监听器，这一事件当有消息到达的时候该事件会触发。这个Listener会被传入一个名为"message"的<a href="https://developer.mozilla.org/en/WebSockets/WebSockets_reference/MessageEvent" rel="nofollow noopener noreferrer" target="_blank"><code>&nbsp;MessageEvent&nbsp;</code></a>对象。</p>
<pre class="prism-token token  language-javascript">socket<span class="token punctuation">.<span class="token function-variable function">onmessage <span class="token operator">= <span class="token keyword">function<span class="token punctuation">(e<span class="token punctuation">) <span class="token punctuation">{
   console<span class="token punctuation">.<span class="token function">log<span class="token punctuation">(<span class="token string">"message received"<span class="token punctuation">, e<span class="token punctuation">, e<span class="token punctuation">.data<span class="token punctuation">)<span class="token punctuation">;
<span class="token punctuation">}<span class="token punctuation">;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre>
<h3>（3）error</h3>
<p>当错误发生时用于监听error事件的事件监听器。会接受一个名为“error”的event对象。</p>
<pre class="prism-token token  language-javascript">socket<span class="token punctuation">.<span class="token function-variable function">onerror <span class="token operator">= <span class="token keyword">function<span class="token punctuation">(e<span class="token punctuation">) <span class="token punctuation">{
   console<span class="token punctuation">.<span class="token function">log<span class="token punctuation">(<span class="token string">"WebSocket Error: " <span class="token punctuation">, e<span class="token punctuation">)<span class="token punctuation">;
<span class="token punctuation">}<span class="token punctuation">;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre>
<h3>（4）close</h3>
<p>用于监听连接关闭事件监听器。当 WebSocket 对象的readyState 状态变为 CLOSED 时会触发该事件。这个监听器会接收一个叫close的<a href="https://developer.mozilla.org/en/WebSockets/WebSockets_reference/CloseEvent" rel="nofollow noopener noreferrer" target="_blank"><code>&nbsp;CloseEvent</code></a>&nbsp;对象。</p>
<pre class="prism-token token  language-javascript">socket<span class="token punctuation">.<span class="token function-variable function">onclose <span class="token operator">= <span class="token keyword">function<span class="token punctuation">(e<span class="token punctuation">) <span class="token punctuation">{
   console<span class="token punctuation">.<span class="token function">log<span class="token punctuation">(<span class="token string">"Connection closed"<span class="token punctuation">, e<span class="token punctuation">)<span class="token punctuation">;
<span class="token punctuation">}<span class="token punctuation">;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre>
<h2>2、方法</h2>
<h3>（1）send</h3>
<p>通过WebSocket连接向服务器发送数据。</p>
<p>一旦在服务端和客户端建立了全双工的双向连接，可以使用send方法去发送消息，当连接是open的时候send()方法传送数据，当连接关闭或获取不到的时候回抛出异常。</p>
<p>一个通常的错误是人们喜欢在连接open之前发送消息。如下所示：</p>
<pre class="prism-token token  language-javascript"><span class="token comment">// 这将不会工作
<span class="token keyword">var socket<span class="token operator">= <span class="token keyword">new <span class="token class-name">WebSocket<span class="token punctuation">(<span class="token string">"ws://localhost:8080"<span class="token punctuation">)
socket<span class="token punctuation">.<span class="token function">send<span class="token punctuation">(<span class="token string">"Initial data"<span class="token punctuation">)<span class="token punctuation">;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre>
<p>应该等待open事件触发后再发送消息，正确的姿势如下：</p>
<pre class="prism-token token  language-javascript"><span class="token keyword">var socket<span class="token operator">= <span class="token keyword">new <span class="token class-name">WebSocket<span class="token punctuation">(<span class="token string">"ws://localhost:8080"<span class="token punctuation">)
   socket<span class="token punctuation">.<span class="token function-variable function">onopen <span class="token operator">= <span class="token keyword">function<span class="token punctuation">(e<span class="token punctuation">) <span class="token punctuation">{
   socket<span class="token punctuation">.<span class="token function">send<span class="token punctuation">(<span class="token string">"Initial data"<span class="token punctuation">)<span class="token punctuation">;
<span class="token punctuation">}</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre>
<h3>（2）close</h3>
<p>关闭WebSocket连接或停止正在进行的连接请求。如果连接的状态已经是<code>closed</code>，这个方法不会有任何效果。</p>
<p>使用close方法来关闭连接，如果连接已经关闭，这方法将什么也不做。调用close方法后，将不能再发送数据。close方法可以传入两个可选的参数，code（numerical）和reason（string）,以告诉服务端为什么终止连接。</p>
<pre class="prism-token token  language-javascript">socket<span class="token punctuation">.<span class="token function">close<span class="token punctuation">(<span class="token number">1000<span class="token punctuation">, <span class="token string">"Closing normally"<span class="token punctuation">)<span class="token punctuation">;
<span class="token comment">//1000是状态码，代表正常结束。</span></span></span></span></span></span></span></span></span></pre>
<h2>&nbsp;</h2>
<h2>3、属性</h2>
<div class="table-wrapper">
<table>
<thead>
<tr><th>
<div class="table-header">
<p>属性名</p>
</div>
</th><th>
<div class="table-header">
<p>类型</p>
</div>
</th><th>
<div class="table-header">
<p>描述</p>
</div>
</th></tr>
</thead>
<tbody>
<tr>
<td>
<div class="table-cell">
<p>binaryType</p>
</div>
</td>
<td>
<div class="table-cell">
<p>DOMString</p>
</div>
</td>
<td>
<div class="table-cell">
<p>一个字符串表示被传输二进制的内容的类型。取值应当是"blob"或者"arraybuffer"。 "blob"表示使用DOMBlob&nbsp;对象，而"arraybuffer"表示使用&nbsp;ArrayBuffer&nbsp;对象。</p>
</div>
</td>
</tr>
<tr>
<td>
<div class="table-cell">
<p>bufferedAmount</p>
</div>
</td>
<td>
<div class="table-cell">
<p>unsigned long</p>
</div>
</td>
<td>
<div class="table-cell">
<p>调用&nbsp;send()&nbsp;方法将多字节数据加入到队列中等待传输，但是还未发出。该值会在所有队列数据被发送后重置为 0。而当连接关闭时不会设为0。如果持续调用send()，这个值会持续增长。只读。</p>
</div>
</td>
</tr>
<tr>
<td>
<div class="table-cell">
<p>extensions</p>
</div>
</td>
<td>
<div class="table-cell">
<p>DOMString</p>
</div>
</td>
<td>
<div class="table-cell">
<p>服务器选定的扩展。目前这个属性只是一个空字符串，或者是一个包含所有扩展的列表。</p>
</div>
</td>
</tr>
<tr>
<td>
<div class="table-cell">
<p>protocol</p>
</div>
</td>
<td>
<div class="table-cell">
<p>DOMString</p>
</div>
</td>
<td>
<div class="table-cell">
<p>一个表明服务器选定的子协议名字的字符串。这个属性的取值会被取值为构造器传入的protocols参数。</p>
</div>
</td>
</tr>
<tr>
<td>
<div class="table-cell">
<p>readyState</p>
</div>
</td>
<td>
<div class="table-cell">
<p>unsigned short</p>
</div>
</td>
<td>
<div class="table-cell">
<p>连接的当前状态。取值是&nbsp;Ready state constants之一。只读。</p>
</div>
</td>
</tr>
<tr>
<td>
<div class="table-cell">
<p>url</p>
</div>
</td>
<td>
<div class="table-cell">
<p>DOMString</p>
</div>
</td>
<td>
<div class="table-cell">
<p>传入构造器的URL。它必须是一个绝对地址的URL。只读。</p>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<h2>4、常量</h2>
<h3>Ready state 常量</h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>
<div class="table-header">
<p>常量</p>
</div>
</th><th>
<div class="table-header">
<p>值</p>
</div>
</th><th>
<div class="table-header">
<p>描述</p>
</div>
</th></tr>
</thead>
<tbody>
<tr>
<td>
<div class="table-cell">
<p>CONNECTING</p>
</div>
</td>
<td>
<div class="table-cell">
<p>0</p>
</div>
</td>
<td>
<div class="table-cell">
<p>连接还没开启。</p>
</div>
</td>
</tr>
<tr>
<td>
<div class="table-cell">
<p>OPEN</p>
</div>
</td>
<td>
<div class="table-cell">
<p>1</p>
</div>
</td>
<td>
<div class="table-cell">
<p>连接已开启并准备好进行通信。</p>
</div>
</td>
</tr>
<tr>
<td>
<div class="table-cell">
<p>CLOSING</p>
</div>
</td>
<td>
<div class="table-cell">
<p>2</p>
</div>
</td>
<td>
<div class="table-cell">
<p>连接正在关闭的过程中。</p>
</div>
</td>
</tr>
<tr>
<td>
<div class="table-cell">
<p>CLOSED</p>
</div>
</td>
<td>
<div class="table-cell">
<p>3</p>
</div>
</td>
<td>
<div class="table-cell">
<p>连接已经关闭，或者连接无法建立。</p>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<h1><strong>三、webSocket与HTTP</strong></h1>
<p>webSocket和http同为协议，大家心里肯定会想它俩之间有什么联系，当然，我也好奇，所以就有了下面的研究结果，呵呵呵呵~~</p>
<p>大家都知道，webSocket是H5的一种新协议（这样看来和http是没什么关系），本质是通过http/https协议进行握手后创建一个用于交换数据的TCP连接，服务端与客户端通过此TCP连接进行实时通信。也就是说，webSocket是http协议上的一种补充。</p>
<p>相对于HTTP这种非持久的协议来说，Websocket是一个持久化的协议。</p>
<p>以php的生命周期为例：</p>
<p>在http1.0中，一个request，一个response，一个周期就结束了。</p>
<p>在http1.1中，有了keep-alive，可以发送多个Request，接收多个Response。但在http中永远是一个request对应一个response。而且这个response是被动的，不能主动发起。</p>
<p>这时候webSocket就派上用场了。</p>
<h1><strong>四、webSocket原理</strong></h1>
<p>首先，先来看一张http的Request Headers：</p>
<div class="image-block"><img src="./HTML5中的webSocket、ajax、http - 一粒一世界 - 博客园_files/3blb8417h5.png" alt=""></div>
<p>再看一张webSocket的：</p>
<div class="image-block"><img src="./HTML5中的webSocket、ajax、http - 一粒一世界 - 博客园_files/xko1nvurqg.png" alt=""></div>
<p>以及webSocket的Response Headers：</p>
<div class="image-block"><img src="./HTML5中的webSocket、ajax、http - 一粒一世界 - 博客园_files/0bxjgmwjuk.png" alt=""></div>
<p>I guess，无论熟不熟悉http，想必都看出了区别，哈哈哈。接下来就要对这些东西进行讲解啦：</p>
<h3>（1）Upgrade和Connection</h3>
<pre class="prism-token token  language-javascript">Upgrade<span class="token punctuation">: websocket
Connection<span class="token punctuation">: Upgrade</span></span></pre>
<p>这个就是webSocket的核心，告诉Apache、ngix等服务器：注意啦，我发起的是webSocket协议，快点帮我找到对应的助理处理~ 不是那个老土的http。</p>
<h3>（2）Sec-WebSocket-Key、Sec-WebSocket-Extensions和Sec-WebSocket-Version</h3>
<pre class="prism-token token  language-javascript">Sec<span class="token operator">-WebSocket<span class="token operator">-Key<span class="token punctuation">: x3JJHMbDL1EzLkh9GBhXDw<span class="token operator">==
Sec<span class="token operator">-WebSocket<span class="token operator">-Extensions<span class="token punctuation">: chat<span class="token punctuation">, superchat
Sec<span class="token operator">-WebSocket<span class="token operator">-Version<span class="token punctuation">: <span class="token number">13</span></span></span></span></span></span></span></span></span></span></span></span></pre>
<p>这个很好理解啦，首先，<strong>Sec-WebSocket-Key</strong>是一个Base64 encode的值，这个是浏览器随机生成的，告诉服务器：尼好，我是webSocket，这是我的ID卡，让我过去吧。</p>
<p>然后，<strong>Sec-WebSocket-Extensions</strong>：协议扩展， 某类协议可能支持多个扩展，通过它可以实现协议增强</p>
<p>最后，<strong>Sec-WebSocket-Version</strong>是告诉服务器所使用的webSocket Draft（协议版本）。喏，我是小喵4.1版本哆啦A梦，哈哈哈哈哈哈哈哈。</p>
<p>然后只要服务器返回了上面我放的那一系列balabala的东西，就代表已经接受请求，webSocket建立成功啦！</p>
<h3>（3）Sec-WebSocket-Accept和Sec-WebSocket-Extensions</h3>
<p>请求时，webSocket会自带加密过的ID卡过来让服务端验证；</p>
<p>对应的，接受请求之后，服务端也得搞一个安全卡（Accept头域的值就是Key的值，是由浏览器发过来的Sec-WebSocket-Key生成的）来证明是我同意你通过的，而不是什么肯蒙拐骗的坏银-&gt;</p>
<p>就这样，原理部分就说完啦，握手成功！</p>
<h1><strong>五、webSocket的作用</strong></h1>
<p>说webSocket之前，先说一下ajax轮询和long poll。</p>
<h2>1、ajax轮询：</h2>
<p>ajax轮询很简单，就是让浏览器隔个几秒就发送一次请求，询问服务器是否有新信息。</p>
<pre class="prism-token token  language-javascript">客户端：hello <span class="token function">hello，有没有新信息<span class="token punctuation">(Request<span class="token punctuation">)

服务端：没有（Response）

客户端：hello <span class="token function">hello，有没有新信息<span class="token punctuation">(Request<span class="token punctuation">)

服务端：没有。。（Response）

客户端：hello <span class="token function">hello，有没有新信息<span class="token punctuation">(Request<span class="token punctuation">)

服务端：你好烦啊，没有啊。。（Response）

客户端：hello hello，有没有新消息（Request）

服务端：有啦有啦，here you are（Response）

客户端：hello hello，有没有新消息（Request）

服务端：。。没。。。。没。。。没。。。。（Response）</span></span></span></span></span></span></span></span></span></pre>
<h2>&nbsp;</h2>
<h2>2、long poll</h2>
<p>long poll和ajax轮询原理很像，不过long poll是阻塞模型，简单来说，就是一直给你打电话，直到你接听为止。</p>
<pre class="prism-token token  language-javascript">客户端：hello hello，有没有新信息，没有的话就等有了再返回给我吧（Request）

服务端：额。。。     （。。。。等待到有消息的时候。。。。）     有了，给你（Response）</pre>
<p>很明显，ajax轮询和long poll弊大于利：</p>
<h3>（1）被动性</h3>
<p>上面这两种方式都是客户端先主动消息给服务端，然后等待服务端应答，要知道，等待总是难熬的，如果服务端能主动发消息多好，这也就是缺点之一：被动性。</p>
<h3>（2）非常消耗资源</h3>
<p>ajax轮询 需要服务器有很快的处理速度和资源（速度）；</p>
<p>long poll 需要有很高的并发，也就是说同时接待客户的能力（场地大小）。</p>
<p>so，当ajax轮询和long poll碰上503（啊啊啊啊啊，game over）</p>
<p>这时候，神奇的webSocket又派上用场了。</p>
<h3>&nbsp;</h3>
<h2>3、webSocket</h2>
<h3>（1）被动性</h3>
<p>首先，解决被动性：</p>
<pre class="prism-token token  language-javascript">客户端：hello hello，我要建立webSocket协议，扩展服务：chat，Websocket，协议版本：<span class="token number">17（HTTP Request）

服务端：ok，确认，已升级为webSocket协议（HTTP Protocols Switched）

客户端：麻烦你有信息的时候推送给我噢。。

服务端：ok，有的时候会告诉你的。

服务端：balabalabalabala

服务端：balabalabalabala

服务端：哈哈哈哈哈啊哈哈哈哈

服务端：笑死我了哈哈哈哈哈哈哈</span></pre>
<p>就这样，只需要一次http请求，就会有源源不断的信息传送了，是不是很方便。</p>
<h3>（2）消耗资源问题</h3>
<p>首先，了解一下，我们所用的程序是要经过两层代理的，即http协议在Nginx等服务器的解析下，然后再传送给相应的Handler（PHP等）来处理。简单地说，我们有一个非常快速的接线员（Nginx），他负责把问题转交给相应的客服（Handler）&nbsp;。</p>
<p>本身接线员基本上速度是足够的，但是每次都卡在客服（Handler）了，老有客服处理速度太慢，导致客服不够。</p>
<p>webSocket就解决了这样一个难题，建立后，可以直接跟接线员建立持久连接，有信息的时候客服想办法通知接线员，然后接线员再统一转交给客户。</p>
<p>这样就可以解决客服处理速度过慢的问题了。</p>
<p>同时，在传统的方式上，要不断的建立，关闭HTTP协议，由于HTTP是非状态性的，每次都要重新传输鉴别信息，来告诉服务端你是谁。</p>
<p>虽然接线员很快速，但是每次都要听这么一堆，效率也会有所下降的，同时还得不断把这些信息转交给客服，不但浪费客服的处理时间，而且还会在网路传输中消耗过多的流量/时间。</p>
<p>但是webSocket只需要一次http握手，所以说整个通讯过程是建立在一次连接/状态中，也就避免了http的非状态性，服务端会一直知道你的信息，直到你关闭请求，这样就解决了接线员要反复解析http协议，还要查看identity info的信息。</p>
<h1><strong>六、Socket.io</strong></h1>
<p>既然说到了webSocket，就难免扯到socket.io。</p>
<p>有人说socket.io就是对webSocket的封装，并且实现了webSocket的服务端代码。可以这样说，但不完全正确。</p>
<p>在webSocket没有出现之前，实现与服务端的实时通讯可以通过轮询来完成任务。Socket.io将webSocket和轮询（Polling）机制以及其它的实时通信方式封装成了通用的接口，并且在服务端实现了这些实时机制的相应代码。也就是说，webSocket仅仅是Socket.io实现实时通信的一个子集。</p>
<p>下面直接上一个用socket.io做的小小聊天室吧。</p>
<p>（1）首先你得有node，然后安装socket.io。</p>
<pre class="prism-token token  language-javascript">$ npm install socket<span class="token punctuation">.io</span></pre>
<p>（2）服务器端（index.js）</p>
<pre class="prism-token token  language-javascript"><span class="token string">'use strict'<span class="token punctuation">;
module<span class="token punctuation">.exports <span class="token operator">= <span class="token function">require<span class="token punctuation">(<span class="token string">'./lib/express'<span class="token punctuation">)<span class="token punctuation">;

<span class="token keyword">var app <span class="token operator">= <span class="token function">require<span class="token punctuation">(<span class="token string">'express'<span class="token punctuation">)<span class="token punctuation">(<span class="token punctuation">)<span class="token punctuation">;
<span class="token keyword">var http <span class="token operator">= <span class="token function">require<span class="token punctuation">(<span class="token string">'http'<span class="token punctuation">)<span class="token punctuation">.<span class="token function">Server<span class="token punctuation">(app<span class="token punctuation">)<span class="token punctuation">;
<span class="token keyword">var io <span class="token operator">= <span class="token function">require<span class="token punctuation">(<span class="token string">'socket.io'<span class="token punctuation">)<span class="token punctuation">(http<span class="token punctuation">)<span class="token punctuation">;

app<span class="token punctuation">.<span class="token keyword">get<span class="token punctuation">(<span class="token string">'/'<span class="token punctuation">, <span class="token keyword">function<span class="token punctuation">(req<span class="token punctuation">, res<span class="token punctuation">)<span class="token punctuation">{
    res<span class="token punctuation">.<span class="token function">sendFile<span class="token punctuation">(__dirname <span class="token operator">+ <span class="token string">'/index.html'<span class="token punctuation">)<span class="token punctuation">;
<span class="token punctuation">}<span class="token punctuation">)<span class="token punctuation">;

io<span class="token punctuation">.<span class="token function">on<span class="token punctuation">(<span class="token string">'connection'<span class="token punctuation">, <span class="token keyword">function<span class="token punctuation">(socket<span class="token punctuation">)<span class="token punctuation">{
    socket<span class="token punctuation">.<span class="token function">on<span class="token punctuation">(<span class="token string">'message'<span class="token punctuation">,<span class="token keyword">function<span class="token punctuation">(msg<span class="token punctuation">)<span class="token punctuation">{
        console<span class="token punctuation">.<span class="token function">log<span class="token punctuation">(msg<span class="token punctuation">)<span class="token punctuation">;
        socket<span class="token punctuation">.broadcast<span class="token punctuation">.<span class="token function">emit<span class="token punctuation">(<span class="token string">'chat'<span class="token punctuation">,msg<span class="token punctuation">)<span class="token punctuation">;    <span class="token comment">//广播消息
    <span class="token punctuation">}<span class="token punctuation">)
<span class="token punctuation">}<span class="token punctuation">)<span class="token punctuation">;

http<span class="token punctuation">.<span class="token function">listen<span class="token punctuation">(<span class="token number">3000<span class="token punctuation">)<span class="token punctuation">;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre>
<p>（3）客户端</p>
<p>先引入js文件：</p>
<pre class="prism-token token  language-javascript"><span class="token operator">&lt;script src<span class="token operator">=<span class="token string">"/socket.io/socket.io.js"<span class="token operator">&gt;<span class="token operator">&lt;<span class="token operator">/script<span class="token operator">&gt;</span></span></span></span></span></span></span></pre>
<p>交互代码（index.html）：</p>
<pre class="prism-token token  language-javascript"><span class="token operator">&lt;<span class="token operator">!DOCTYPE html<span class="token operator">&gt;<span class="token operator">&lt;html<span class="token operator">&gt;<span class="token operator">&lt;head<span class="token operator">&gt;
<span class="token operator">&lt;meta charset<span class="token operator">=<span class="token string">"UTF-8"<span class="token operator">&gt;
<span class="token operator">&lt;title<span class="token operator">&gt;聊天室<span class="token operator">&lt;<span class="token operator">/title<span class="token operator">&gt;
<span class="token operator">&lt;style<span class="token operator">&gt;
body<span class="token punctuation">,div<span class="token punctuation">,ul<span class="token punctuation">,li<span class="token punctuation">{margin<span class="token punctuation">: <span class="token number">0<span class="token punctuation">;padding<span class="token punctuation">: <span class="token number">0<span class="token punctuation">;list<span class="token operator">-style<span class="token punctuation">: none<span class="token punctuation">;<span class="token punctuation">}
<span class="token punctuation">.auto<span class="token punctuation">{margin<span class="token punctuation">: auto<span class="token punctuation">;<span class="token punctuation">}
<span class="token punctuation">.l<span class="token punctuation">{text<span class="token operator">-align<span class="token punctuation">: left<span class="token punctuation">;<span class="token punctuation">}
<span class="token punctuation">.r<span class="token punctuation">{text<span class="token operator">-align<span class="token punctuation">: right<span class="token punctuation">;<span class="token punctuation">}
<span class="token punctuation">.flex<span class="token punctuation">{display<span class="token punctuation">: box<span class="token punctuation">;display<span class="token punctuation">: <span class="token operator">-webkit<span class="token operator">-box<span class="token punctuation">;display<span class="token punctuation">: <span class="token operator">-moz<span class="token operator">-box<span class="token punctuation">;display<span class="token punctuation">: <span class="token operator">-ms<span class="token operator">-flexbox<span class="token punctuation">;display<span class="token punctuation">: <span class="token operator">-webkit<span class="token operator">-flex<span class="token punctuation">;display<span class="token punctuation">: flex<span class="token punctuation">;<span class="token operator">-webkit<span class="token operator">-box<span class="token operator">-pack<span class="token punctuation">: center<span class="token punctuation">;<span class="token operator">-webkit<span class="token operator">-justify<span class="token operator">-content<span class="token punctuation">: center<span class="token punctuation">;<span class="token operator">-moz<span class="token operator">-justify<span class="token operator">-content<span class="token punctuation">: center<span class="token punctuation">;<span class="token operator">-ms<span class="token operator">-justify<span class="token operator">-content<span class="token punctuation">: center<span class="token punctuation">;<span class="token operator">-o<span class="token operator">-justify<span class="token operator">-content<span class="token punctuation">: center<span class="token punctuation">;justify<span class="token operator">-content<span class="token punctuation">: center<span class="token punctuation">;<span class="token operator">-webkit<span class="token operator">-box<span class="token operator">-align<span class="token punctuation">: center<span class="token punctuation">;<span class="token operator">-webkit<span class="token operator">-align<span class="token operator">-items<span class="token punctuation">: center<span class="token punctuation">;<span class="token operator">-moz<span class="token operator">-align<span class="token operator">-items<span class="token punctuation">: center<span class="token punctuation">;<span class="token operator">-ms<span class="token operator">-align<span class="token operator">-items<span class="token punctuation">: center<span class="token punctuation">;<span class="token operator">-o<span class="token operator">-align<span class="token operator">-items<span class="token punctuation">: center<span class="token punctuation">;align<span class="token operator">-items<span class="token punctuation">: center<span class="token punctuation">;<span class="token punctuation">}
<span class="token punctuation">.chat<span class="token operator">-box<span class="token punctuation">{background<span class="token punctuation">: #f1f1f1<span class="token punctuation">;width<span class="token punctuation">: 56vw<span class="token punctuation">;padding<span class="token punctuation">:2vw<span class="token punctuation">;height<span class="token punctuation">:36vw<span class="token punctuation">;border<span class="token punctuation">:1px solid #ccc<span class="token punctuation">;margin<span class="token operator">-top<span class="token punctuation">: 2vw<span class="token punctuation">;<span class="token punctuation">}
<span class="token punctuation">.chat<span class="token operator">-li<span class="token punctuation">{display<span class="token punctuation">:inline<span class="token operator">-block<span class="token punctuation">;margin<span class="token operator">-top<span class="token punctuation">: 5px<span class="token punctuation">;background<span class="token punctuation">: #5CB85C<span class="token punctuation">;border<span class="token operator">-radius<span class="token punctuation">: 5px<span class="token punctuation">;padding<span class="token punctuation">: 3px 10px<span class="token punctuation">;color<span class="token punctuation">: #fff<span class="token punctuation">;<span class="token punctuation">}
<span class="token punctuation">.other<span class="token operator">-chat<span class="token operator">-li<span class="token punctuation">{background<span class="token punctuation">: #fff<span class="token punctuation">;color<span class="token punctuation">: #<span class="token number">333<span class="token punctuation">;<span class="token punctuation">}
<span class="token punctuation">.send<span class="token operator">-box<span class="token punctuation">{width<span class="token punctuation">: 60vw<span class="token punctuation">;border<span class="token punctuation">:1px solid #ccc<span class="token punctuation">;justify<span class="token operator">-content<span class="token punctuation">: space<span class="token operator">-between<span class="token punctuation">;border<span class="token operator">-top<span class="token punctuation">: <span class="token number">0<span class="token punctuation">;<span class="token punctuation">}
<span class="token punctuation">.send<span class="token operator">-text<span class="token punctuation">{width<span class="token punctuation">: 50vw<span class="token punctuation">; border<span class="token punctuation">: none<span class="token punctuation">; padding<span class="token punctuation">: 10px<span class="token punctuation">;outline<span class="token punctuation">:<span class="token number">0<span class="token punctuation">;<span class="token punctuation">}
<span class="token punctuation">.send<span class="token punctuation">{width<span class="token punctuation">: 10vw<span class="token punctuation">;background<span class="token punctuation">: #5cb85c<span class="token punctuation">; border<span class="token punctuation">: none<span class="token punctuation">; padding<span class="token punctuation">: 10px<span class="token punctuation">;color<span class="token punctuation">: #fff<span class="token punctuation">;cursor<span class="token punctuation">: pointer<span class="token punctuation">;<span class="token punctuation">}
<span class="token punctuation">.chat<span class="token operator">-name<span class="token punctuation">{color<span class="token punctuation">: #f00<span class="token punctuation">;<span class="token punctuation">}
<span class="token punctuation">.other<span class="token operator">-box<span class="token punctuation">,<span class="token punctuation">.self<span class="token operator">-box<span class="token punctuation">{width<span class="token punctuation">: <span class="token number">50<span class="token operator">%<span class="token punctuation">;height<span class="token punctuation">:<span class="token number">100<span class="token operator">%<span class="token punctuation">;<span class="token punctuation">}
<span class="token operator">&lt;<span class="token operator">/style<span class="token operator">&gt;
<span class="token operator">&lt;<span class="token operator">/head<span class="token operator">&gt;
<span class="token operator">&lt;body<span class="token operator">&gt;
    <span class="token operator">&lt;div <span class="token keyword">class<span class="token operator">=<span class="token string">"chat-box auto flex"<span class="token operator">&gt;
        <span class="token operator">&lt;ul <span class="token keyword">class<span class="token operator">=<span class="token string">"other-box l"<span class="token operator">&gt;<span class="token operator">&lt;<span class="token operator">/ul<span class="token operator">&gt;
        <span class="token operator">&lt;ul <span class="token keyword">class<span class="token operator">=<span class="token string">"self-box r"<span class="token operator">&gt;<span class="token operator">&lt;<span class="token operator">/ul<span class="token operator">&gt;
    <span class="token operator">&lt;<span class="token operator">/div<span class="token operator">&gt;
    <span class="token operator">&lt;div <span class="token keyword">class<span class="token operator">=<span class="token string">"flex send-box auto"<span class="token operator">&gt;
        <span class="token operator">&lt;input <span class="token keyword">class<span class="token operator">=<span class="token string">"send-text" type<span class="token operator">=<span class="token string">"text"<span class="token operator">&gt;
        <span class="token operator">&lt;button <span class="token keyword">class<span class="token operator">=<span class="token string">"send" type<span class="token operator">=<span class="token string">"button"<span class="token operator">&gt;发送<span class="token operator">&lt;<span class="token operator">/button<span class="token operator">&gt;
    <span class="token operator">&lt;<span class="token operator">/div<span class="token operator">&gt;
<span class="token operator">&lt;<span class="token operator">/body<span class="token operator">&gt;
<span class="token operator">&lt;script src<span class="token operator">=<span class="token string">"/socket.io/socket.io.js"<span class="token operator">&gt;<span class="token operator">&lt;<span class="token operator">/script<span class="token operator">&gt;
<span class="token operator">&lt;script src<span class="token operator">=<span class="token string">"https://code.jquery.com/jquery-1.11.1.js"<span class="token operator">&gt;<span class="token operator">&lt;<span class="token operator">/script<span class="token operator">&gt;
<span class="token operator">&lt;script<span class="token operator">&gt;
    <span class="token function">$<span class="token punctuation">(<span class="token keyword">function<span class="token punctuation">(<span class="token punctuation">)<span class="token punctuation">{  
        <span class="token keyword">var socket <span class="token operator">= <span class="token function">io<span class="token punctuation">(<span class="token punctuation">)<span class="token punctuation">;
        
        <span class="token function">$<span class="token punctuation">(<span class="token string">".send"<span class="token punctuation">)<span class="token punctuation">.<span class="token function">click<span class="token punctuation">(<span class="token keyword">function<span class="token punctuation">(<span class="token punctuation">)<span class="token punctuation">{
            <span class="token keyword">var msg <span class="token operator">= <span class="token function">$<span class="token punctuation">(<span class="token string">".send-text"<span class="token punctuation">)<span class="token punctuation">.<span class="token function">val<span class="token punctuation">(<span class="token punctuation">)<span class="token punctuation">;
            <span class="token keyword">if<span class="token punctuation">(msg <span class="token operator">!= <span class="token string">""<span class="token punctuation">)<span class="token punctuation">{
                socket<span class="token punctuation">.<span class="token function">send<span class="token punctuation">(msg<span class="token punctuation">)<span class="token punctuation">;
                <span class="token function">$<span class="token punctuation">(<span class="token string">'.self-box'<span class="token punctuation">)<span class="token punctuation">.<span class="token function">append<span class="token punctuation">(<span class="token string">'&lt;li class="chat-li"&gt;'<span class="token operator">+ msg <span class="token operator">+<span class="token string">'&lt;li&gt;'<span class="token punctuation">)<span class="token punctuation">;
                <span class="token function">$<span class="token punctuation">(<span class="token string">".send-text"<span class="token punctuation">)<span class="token punctuation">.<span class="token function">val<span class="token punctuation">(<span class="token string">""<span class="token punctuation">)<span class="token punctuation">;
            <span class="token punctuation">}<span class="token keyword">else<span class="token punctuation">{
                <span class="token keyword">return <span class="token boolean">false<span class="token punctuation">;
            <span class="token punctuation">}
        <span class="token punctuation">}<span class="token punctuation">)
        
        <span class="token function">$<span class="token punctuation">(<span class="token string">".send-text"<span class="token punctuation">)<span class="token punctuation">.<span class="token function">keydown<span class="token punctuation">(<span class="token keyword">function<span class="token punctuation">(event<span class="token punctuation">)<span class="token punctuation">{
            <span class="token keyword">if<span class="token punctuation">(event<span class="token punctuation">.keyCode <span class="token operator">== <span class="token number">13<span class="token punctuation">)<span class="token punctuation">{
                <span class="token keyword">var msg <span class="token operator">= <span class="token function">$<span class="token punctuation">(<span class="token string">".send-text"<span class="token punctuation">)<span class="token punctuation">.<span class="token function">val<span class="token punctuation">(<span class="token punctuation">)<span class="token punctuation">;
                <span class="token keyword">if<span class="token punctuation">(msg <span class="token operator">!= <span class="token string">""<span class="token punctuation">)<span class="token punctuation">{
                    socket<span class="token punctuation">.<span class="token function">send<span class="token punctuation">(msg<span class="token punctuation">)<span class="token punctuation">;
                    <span class="token function">$<span class="token punctuation">(<span class="token string">'.self-box'<span class="token punctuation">)<span class="token punctuation">.<span class="token function">append<span class="token punctuation">(<span class="token string">'&lt;li class="chat-li"&gt;'<span class="token operator">+ msg <span class="token operator">+<span class="token string">'&lt;li&gt;'<span class="token punctuation">)<span class="token punctuation">;
                    <span class="token function">$<span class="token punctuation">(<span class="token string">".send-text"<span class="token punctuation">)<span class="token punctuation">.<span class="token function">val<span class="token punctuation">(<span class="token string">""<span class="token punctuation">)<span class="token punctuation">;
                <span class="token punctuation">}<span class="token keyword">else<span class="token punctuation">{
                    <span class="token keyword">return <span class="token boolean">false<span class="token punctuation">;
                <span class="token punctuation">}
            <span class="token punctuation">}
        <span class="token punctuation">}<span class="token punctuation">)

        socket<span class="token punctuation">.<span class="token function">on<span class="token punctuation">(<span class="token string">"chat"<span class="token punctuation">,<span class="token keyword">function<span class="token punctuation">(msg<span class="token punctuation">)<span class="token punctuation">{
            <span class="token function">$<span class="token punctuation">(<span class="token string">'.other-box'<span class="token punctuation">)<span class="token punctuation">.<span class="token function">append<span class="token punctuation">(<span class="token string">'&lt;li class="other-chat-li chat-li"&gt;'<span class="token operator">+ msg <span class="token operator">+<span class="token string">'&lt;li&gt;'<span class="token punctuation">)<span class="token punctuation">;
        <span class="token punctuation">}<span class="token punctuation">)
    <span class="token punctuation">}<span class="token punctuation">)
<span class="token operator">&lt;<span class="token operator">/script<span class="token operator">&gt;
<span class="token operator">&lt;<span class="token operator">/html<span class="token operator">&gt;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></pre>
<p>（4）运行代码：</p>
<pre class="prism-token token  language-javascript">$ node index<span class="token punctuation">.js</span></pre>
<p>然后打开两个浏览器页面（<strong>http://localhost:3000/</strong>），就可以聊天啦，至于聊天名称呀、聊天头像呀什么的，可以自己去研究罗~~~</p>
<p>下面是效果图：</p>
<div class="image-block"><img src="./HTML5中的webSocket、ajax、http - 一粒一世界 - 博客园_files/6ir0axkcht.png" alt="" width="1593" height="823"></div>
<p>到底为止啦，感觉好像裹脚布，so long~~~~~~~</p>
</div>
</div>
<div id="MySignature"></div>
<div class="clear"></div>
<div id="blog_post_info_block"><div id="BlogPostCategory">
    分类: 
            <a href="https://www.cnblogs.com/leftJS/category/1492675.html" target="_blank">01HTML/CSS</a></div>


    <div id="blog_post_info">
<div id="green_channel">
        <a href="javascript:void(0);" id="green_channel_digg" onclick="DiggIt(11041346,cb_blogId,1);green_channel_success(this,&#39;谢谢推荐！&#39;);">好文要顶</a>
        <a id="green_channel_follow" onclick="follow(&#39;e16bd9c4-e360-4df3-015b-08d67c7ebe24&#39;);" href="javascript:void(0);">关注我</a>
    <a id="green_channel_favorite" onclick="AddToWz(cb_entryId);return false;" href="javascript:void(0);">收藏该文</a>
    <a id="green_channel_weibo" href="javascript:void(0);" title="分享至新浪微博" onclick="ShareToTsina()"><img src="./HTML5中的webSocket、ajax、http - 一粒一世界 - 博客园_files/icon_weibo_24.png" alt=""></a>
    <a id="green_channel_wechat" href="javascript:void(0);" title="分享至微信" onclick="shareOnWechat()"><img src="./HTML5中的webSocket、ajax、http - 一粒一世界 - 博客园_files/wechat.png" alt=""></a>
</div>
<div id="author_profile">
    <div id="author_profile_info" class="author_profile_info">
        <div id="author_profile_detail" class="author_profile_info">
            <a href="https://home.cnblogs.com/u/leftJS/">一粒一世界</a><br>
            <a href="https://home.cnblogs.com/u/leftJS/followees/">关注 - 0</a><br>
            <a href="https://home.cnblogs.com/u/leftJS/followers/">粉丝 - 3</a>
        </div>
    </div>
    <div class="clear"></div>
    <div id="author_profile_honor"></div>
    <div id="author_profile_follow">
                <a href="javascript:void(0);" onclick="follow(&#39;e16bd9c4-e360-4df3-015b-08d67c7ebe24&#39;);return false;">+加关注</a>
    </div>
</div>
<div id="div_digg">
    <div class="diggit" onclick="votePost(11041346,&#39;Digg&#39;)">
        <span class="diggnum" id="digg_count">0</span>
    </div>
    <div class="buryit" onclick="votePost(11041346,&#39;Bury&#39;)">
        <span class="burynum" id="bury_count">0</span>
    </div>
    <div class="clear"></div>
    <div class="diggword" id="digg_tips">
    </div>
</div>

<script type="text/javascript">
    currentDiggType = 0;
</script></div>
    <div class="clear"></div>
    <div id="post_next_prev">

    <a href="https://www.cnblogs.com/leftJS/p/11038879.html" class="p_n_p_prefix">« </a> 上一篇：    <a href="https://www.cnblogs.com/leftJS/p/11038879.html" title="发布于 2019-06-17 11:42">HTML5中的Web Workers</a>
    <br>
    <a href="https://www.cnblogs.com/leftJS/p/11041410.html" class="p_n_p_prefix">» </a> 下一篇：    <a href="https://www.cnblogs.com/leftJS/p/11041410.html" title="发布于 2019-06-17 18:24">HTML5中的SSE（服务器推送技术）</a>

</div>
</div>
            </div>
            <div class="postDesc">posted @ 
<span id="post-date">2019-06-17 18:13</span>&nbsp;<a href="https://www.cnblogs.com/leftJS/">一粒一世界</a> 阅读(<span id="post_view_count">233</span>) 评论(<span id="post_comment_count">0</span>) <a href="https://i.cnblogs.com/EditPosts.aspx?postid=11041346" rel="nofollow"> 编辑</a> <a href="javascript:void(0)" onclick="AddToWz(11041346); return false;">收藏</a>
</div>
        </div>
	    
	    
    </div><!--end: topics 文章、评论容器-->
</div>
<script src="./HTML5中的webSocket、ajax、http - 一粒一世界 - 博客园_files/highlight.min.js.下载"></script>
<script>markdown_highlight();</script>
<script>
    var allowComments = true, cb_blogId = 489310, cb_blogApp = 'leftJS', cb_blogUserGuid = 'e16bd9c4-e360-4df3-015b-08d67c7ebe24';
    var cb_entryId = 11041346, cb_entryCreatedDate = '2019-06-17 18:13', cb_postType = 1; 
    loadViewCount(cb_entryId);
</script><a name="!comments"></a>
<div id="blog-comments-placeholder"></div>
<script>
    var commentManager = new blogCommentManager();
    commentManager.renderComments(0);
</script>

<div id="comment_form" class="commentform">
    <a name="commentform"></a>
    <div id="divCommentShow"></div>
    <div id="comment_nav"><span id="span_refresh_tips"></span><a href="javascript:void(0);" onclick="return RefreshCommentList();" id="lnk_RefreshComments" runat="server" clientidmode="Static">刷新评论</a><a href="https://www.cnblogs.com/leftJS/p/11041346.html#" onclick="return RefreshPage();">刷新页面</a><a href="https://www.cnblogs.com/leftJS/p/11041346.html#top">返回顶部</a></div>
    <div id="comment_form_container"><div class="login_tips">
    注册用户登录后才能发表评论，请 
    <a rel="nofollow" href="javascript:void(0);" class="underline" onclick="return login(&#39;commentform&#39;);">登录</a>
     或 
    <a rel="nofollow" href="javascript:void(0);" class="underline" onclick="return register();">注册</a>，
    <a href="https://www.cnblogs.com/">访问</a> 网站首页。
</div></div>
    <div class="ad_text_commentbox" id="ad_text_under_commentbox"></div>
    <div id="ad_t2"><a href="https://cloud.tencent.com/act/pro/overseas?fromSource=gwzcw.3090393.3090393.3090393&amp;utm_medium=cpc&amp;utm_id=gwzcw.3090393.3090393.3090393" target="_blank" onclick="ga(&#39;send&#39;, &#39;event&#39;, &#39;Link&#39;, &#39;click&#39;, &#39;T2-腾讯云&#39;)">【推荐】腾讯云海外1核2G云服务器低至2折，半价续费券限量免费领取！</a><br><a href="https://www.jdcloud.com/cn/activity/year-end?utm_source=DMT_cnblogs&amp;utm_medium=CH&amp;utm_campaign=q4vm&amp;utm_term=Virtual-Machines" target="_blank" onclick="ga(&#39;send&#39;, &#39;event&#39;, &#39;Link&#39;, &#39;click&#39;, &#39;T2-京东云&#39;)">【活动】京东云服务器_云主机低于1折，低价高性能产品备战双11</a><br><a href="http://www.ucancode.com/index.htm" target="_blank" onclick="ga(&#39;send&#39;, &#39;event&#39;, &#39;Link&#39;, &#39;click&#39;, &#39;T2-工控&#39;)">【推荐】超50万行VC++源码: 大型组态工控、电力仿真CAD与GIS源码库</a><br><a href="https://ke.qq.com/huodong/mashibing_pc/index.html?from=800018451" target="_blank" onclick="ga(&#39;send&#39;, &#39;event&#39;, &#39;Link&#39;, &#39;click&#39;, &#39;T2-马士兵&#39;)">【课程】马士兵老师一对一职业规划指导！程序员突破年薪80W！</a><br><a href="https://www.ctyun.cn/activity/20191111?hmsr=%E7%9C%8B%E7%9C%8B-%E5%8D%9A%E5%AE%A2%E5%9B%AD-%E5%8F%8C11-1106&amp;hmpl=&amp;hmcu=&amp;hmkw=&amp;hmci=" target="_blank" onclick="ga(&#39;send&#39;, &#39;event&#39;, &#39;Link&#39;, &#39;click&#39;, &#39;T2-天翼云&#39;)">【推荐】天翼云双十一翼降到底，云主机11.11元起，抽奖送大礼</a><br><a href="https://ke.qq.com/huodong/xiangxueketang_pc/index.html?from=800018909" target="_blank" onclick="ga(&#39;send&#39;, &#39;event&#39;, &#39;Link&#39;, &#39;click&#39;, &#39;T2-享学&#39;)">【课程】2019年这些技术点你都不懂的话，如何去争取高薪呢？</a><br><a href="https://www.uibot.com.cn/sem/bky.html" target="_blank" onclick="ga(&#39;send&#39;, &#39;event&#39;, &#39;Link&#39;, &#39;click&#39;, &#39;T2-uibot_T2&#39;)">【推荐】流程自动化专家UiBot，体系化教程成就高薪RPA工程师</a><br></div>
    <div id="opt_under_post"></div>
    <script async="async" src="./HTML5中的webSocket、ajax、http - 一粒一世界 - 博客园_files/gpt.js.下载"></script>
    <script>
        var googletag = googletag || {};
        googletag.cmd = googletag.cmd || [];
    </script>
    <script>
        googletag.cmd.push(function () {
            googletag.defineSlot("/1090369/C1", [300, 250], "div-gpt-ad-1546353474406-0").addService(googletag.pubads());
            googletag.defineSlot("/1090369/C2", [468, 60], "div-gpt-ad-1539008685004-0").addService(googletag.pubads());
            googletag.pubads().enableSingleRequest();
            googletag.enableServices();
        });
    </script>
    <div id="cnblogs_c1" class="c_ad_block">
        <div id="div-gpt-ad-1546353474406-0" style="height:250px; width:300px;" data-google-query-id="CJ6Nk5PA8-UCFQ7Dlgodxa8ANw"><div id="google_ads_iframe_/1090369/C1_0__container__" style="border: 0pt none;"><iframe id="google_ads_iframe_/1090369/C1_0" title="3rd party ad content" name="google_ads_iframe_/1090369/C1_0" width="300" height="250" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" style="border: 0px; vertical-align: bottom;" data-google-container-id="1" data-load-complete="true" src="./HTML5中的webSocket、ajax、http - 一粒一世界 - 博客园_files/saved_resource.html"></iframe></div></div>
    </div>
    <div id="under_post_news"><div class="recomm-block"><b>相关博文：</b><br>·  <a title="看完让你彻底搞懂Websocket原理" href="https://www.cnblogs.com/fuqiang88/p/5956363.html" target="_blank" onclick="clickRecomItmem(5956363)">看完让你彻底搞懂Websocket原理</a><br>·  <a title="WebSocket 详解教程" href="https://www.cnblogs.com/jingmoxukong/p/7755643.html" target="_blank" onclick="clickRecomItmem(7755643)">WebSocket 详解教程</a><br>·  <a title="认识HTML5的WebSocket" href="https://www.cnblogs.com/wei2yi/archive/2011/03/23/1992830.html" target="_blank" onclick="clickRecomItmem(1992830)">认识HTML5的WebSocket</a><br>·  <a title="学习html5的WebSocket连接" href="https://www.cnblogs.com/shizhouyu/p/4975409.html" target="_blank" onclick="clickRecomItmem(4975409)">学习html5的WebSocket连接</a><br>·  <a title="java中websocket的应用" href="https://www.cnblogs.com/roy-blog/p/7211761.html" target="_blank" onclick="clickRecomItmem(7211761)">java中websocket的应用</a><br>»  <a target="_blank" href="https://recomm.cnblogs.com/blogpost/11041346">更多推荐...</a></div></div>
    <div id="cnblogs_c2" class="c_ad_block">
        <div id="div-gpt-ad-1539008685004-0" style="height:60px; width:468px;" data-google-query-id="CJ-Nk5PA8-UCFQ7Dlgodxa8ANw">
            
        <div id="google_ads_iframe_/1090369/C2_0__container__" style="border: 0pt none;"><iframe id="google_ads_iframe_/1090369/C2_0" title="3rd party ad content" name="google_ads_iframe_/1090369/C2_0" width="468" height="60" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" style="border: 0px; vertical-align: bottom;" data-google-container-id="2" data-load-complete="true" src="./HTML5中的webSocket、ajax、http - 一粒一世界 - 博客园_files/saved_resource(1).html"></iframe></div></div>
    </div>
    <div id="under_post_kb">
<div class="itnews c_ad_block">
    <b>最新 IT 新闻</b>:
    <br>
 ·              <a href="https://news.cnblogs.com/n/647715/" target="_blank">微软拟2020年推出云游戏服务XCloud 支持PS4手柄</a>
            <br>
 ·              <a href="https://news.cnblogs.com/n/647714/" target="_blank">Chrome、Edge 和 Safari 在中国安全挑战赛上被攻陷</a>
            <br>
 ·              <a href="https://news.cnblogs.com/n/647713/" target="_blank">美研究者绘制土卫六首个整体地质图</a>
            <br>
 ·              <a href="https://news.cnblogs.com/n/647712/" target="_blank">乐视大厦司法拍卖被叫停</a>
            <br>
 ·              <a href="https://news.cnblogs.com/n/647711/" target="_blank">新物质态库珀对量子金属态首次证实，有望催生新型电子设备</a>
            <br>
    » <a href="https://news.cnblogs.com/" title="IT 新闻" target="_blank">更多新闻...</a>
</div></div>
    <div id="HistoryToday" class="c_ad_block"></div>
    <script type="text/javascript">
        fixPostBody();
        setTimeout(function () { incrementViewCount(cb_entryId); }, 50);
        deliverAdT2();
        deliverAdC1();
        deliverAdC2();
        loadNewsAndKb();
        loadBlogSignature();
LoadPostCategoriesTags(cb_blogId, cb_entryId);        LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);
        GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate, cb_postType);
        loadOptUnderPost();
        GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);
    </script>
</div>
	</div><!--end: forFlow -->
	</div><!--end: mainContent 主体内容容器-->

	<div id="sideBar">
		<div id="sideBarMain">
			
<div id="sidebar_news" class="newsItem"><!--done-->
<h3 class="catListTitle">公告</h3>

<div id="blog-news">
    
    <div id="profile_block">
        昵称：
        <a href="https://home.cnblogs.com/u/leftJS/">
            一粒一世界
        </a>
        <br>
        园龄：
        <a href="https://home.cnblogs.com/u/leftJS/" title="入园时间：2019-01-18">
            10个月
        </a>
        <br>
        粉丝：
        <a href="https://home.cnblogs.com/u/leftJS/followers/">
            3
        </a>
        <br>
        关注：
        <a href="https://home.cnblogs.com/u/leftJS/followees/">
            0
        </a>
        <div id="p_b_follow">
<a href="javascript:void(0)" onclick="follow(&#39;e16bd9c4-e360-4df3-015b-08d67c7ebe24&#39;)">+加关注</a></div>
        <script>getFollowStatus('e16bd9c4-e360-4df3-015b-08d67c7ebe24');</script>
    </div>
</div>

</div>

			<div id="blog-calendar" style="">

<table id="blogCalendar" class="Cal" cellspacing="0" cellpadding="0" title="Calendar" border="0">
    <tbody>
        <tr>
            <td colspan="7">
                <table class="CalTitle" cellspacing="0" border="0">
                    <tbody>
                        <tr>
                            <td class="CalNextPrev">
                                <a href="javascript:void(0);" onclick="loadBlogCalendar(&#39;2019/10/18&#39;); return false;">&lt;</a>
                            </td>
                            <td align="center">2019年11月</td>
                            <td align="right" class="CalNextPrev">
                                <a href="javascript:void(0);" onclick="loadBlogCalendar(&#39;2019/12/18&#39;); return false;">&gt;</a>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </td>
        </tr>
        <tr>
                    <th class="CalDayHeader" align="center" abbr="日" scope="col">日</th>
                    <th class="CalDayHeader" align="center" abbr="一" scope="col">一</th>
                    <th class="CalDayHeader" align="center" abbr="二" scope="col">二</th>
                    <th class="CalDayHeader" align="center" abbr="三" scope="col">三</th>
                    <th class="CalDayHeader" align="center" abbr="四" scope="col">四</th>
                    <th class="CalDayHeader" align="center" abbr="五" scope="col">五</th>
                    <th class="CalDayHeader" align="center" abbr="六" scope="col">六</th>
        </tr>
            <tr>
                            <td class="CalOtherMonthDay" align="center">27</td>
                            <td class="CalOtherMonthDay" align="center">28</td>
                            <td class="CalOtherMonthDay" align="center">29</td>
                            <td class="CalOtherMonthDay" align="center">30</td>
                            <td class="CalOtherMonthDay" align="center">31</td>
                        <td class="" align="center">
                            1
                        </td>
                    <td class="CalWeekendDay" align="center">
                        2
                    </td>
            </tr>
                <tr>
                        <td class="CalWeekendDay" align="center">
                            3
                        </td>
                            <td class="" align="center">
                                4
                            </td>
                            <td class="" align="center">
                                5
                            </td>
                            <td class="" align="center">
                                6
                            </td>
                            <td class="" align="center">
                                7
                            </td>
                            <td class="" align="center">
                                8
                            </td>
                        <td class="CalWeekendDay" align="center">
                            9
                        </td>
                </tr>
                <tr>
                        <td class="CalWeekendDay" align="center">
                            10
                        </td>
                            <td class="" align="center">
                                11
                            </td>
                            <td class="" align="center">
                                12
                            </td>
                            <td class="" align="center">
                                13
                            </td>
                            <td class="" align="center">
                                14
                            </td>
                            <td class="" align="center">
                                15
                            </td>
                        <td class="CalWeekendDay" align="center">
                            16
                        </td>
                </tr>
                <tr>
                        <td class="CalWeekendDay" align="center">
                            17
                        </td>
                            <td class="CalTodayDay" align="center">
                                18
                            </td>
                            <td class="" align="center">
                                19
                            </td>
                            <td class="" align="center">
                                20
                            </td>
                            <td class="" align="center">
                                21
                            </td>
                            <td class="" align="center">
                                22
                            </td>
                        <td class="CalWeekendDay" align="center">
                            23
                        </td>
                </tr>
                <tr>
                        <td class="CalWeekendDay" align="center">
                            24
                        </td>
                            <td class="" align="center">
                                25
                            </td>
                            <td class="" align="center">
                                26
                            </td>
                            <td class="" align="center">
                                27
                            </td>
                            <td class="" align="center">
                                28
                            </td>
                            <td class="" align="center">
                                29
                            </td>
                        <td class="CalWeekendDay" align="center">
                            30
                        </td>
                </tr>
                <tr>
                        <td class="CalOtherMonthDay" align="center">
                            1
                        </td>
                            <td class="CalOtherMonthDay" align="center">
                                2
                            </td>
                            <td class="CalOtherMonthDay" align="center">
                                3
                            </td>
                            <td class="CalOtherMonthDay" align="center">
                                4
                            </td>
                            <td class="CalOtherMonthDay" align="center">
                                5
                            </td>
                            <td class="CalOtherMonthDay" align="center">
                                6
                            </td>
                        <td class="CalOtherMonthDay" align="center">
                            7
                        </td>
                </tr>
    </tbody>
</table></div><script>loadBlogDefaultCalendar();</script>
			
			<div id="leftcontentcontainer">
				<div id="blog-sidecolumn">
<!-- 搜索 -->
<div id="sidebar_search" class="sidebar-block">
    <div id="sidebar_search" class="mySearch">
        <h3 class="catListTitle">搜索</h3>
        <div id="sidebar_search_box">
            <div id="widget_my_zzk" class="div_my_zzk">
                <input type="text" id="q" onkeydown="return zzk_go_enter(event);" class="input_my_zzk">&nbsp;<input onclick="zzk_go()" type="button" value="找找看" id="btnZzk" class="btn_my_zzk">
            </div>
            <div id="widget_my_google" class="div_my_zzk">
                <input type="text" name="google_q" id="google_q" onkeydown="return google_go_enter(event);" class="input_my_zzk">&nbsp;<input onclick="google_go()" type="button" value="谷歌搜索" class="btn_my_zzk">
            </div>
        </div>
    </div>
</div>

<!-- 常用链接 -->
<div id="sidebar_shortcut" class="sidebar-block">
    <div class="catListLink">
<h3 class="catListTitle">
常用链接
</h3>
<ul>
		<li>

<a href="https://www.cnblogs.com/leftJS/p/" title="我的博客的随笔列表">我的随笔</a>
</li>
		<li>

<a href="https://www.cnblogs.com/leftJS/MyComments.html" title="我的发表过的评论列表">我的评论</a>
</li>
		<li>

<a href="https://www.cnblogs.com/leftJS/OtherPosts.html" title="我评论过的随笔列表">我的参与</a>
</li>
		<li>

<a href="https://www.cnblogs.com/leftJS/RecentComments.html" title="我的博客的评论列表">最新评论</a>
</li>
		<li>

<a href="https://www.cnblogs.com/leftJS/tag/" title="我的博客的标签列表">我的标签</a>
</li>

</ul>
<div id="itemListLin_con" style="display:none;">
<ul>

</ul>
</div>
</div>


</div>

<!-- 最新随笔 -->
<div id="sidebar_recentposts" class="sidebar-block">
    <div class="catListEssay">
<h3 class="catListTitle">最新随笔</h3>
<ul>
                <li>
                    

<a href="https://www.cnblogs.com/leftJS/p/11105909.html">1.项目中遇到哪些难点，如何解决的</a>

                </li>
                <li>
                    

<a href="https://www.cnblogs.com/leftJS/p/11099488.html">2.vue双向绑定、Proxy、defineproperty</a>

                </li>
                <li>
                    

<a href="https://www.cnblogs.com/leftJS/p/11099478.html">3.Proxy相比于defineProperty的优势</a>

                </li>
                <li>
                    

<a href="https://www.cnblogs.com/leftJS/p/11099394.html">4.axios</a>

                </li>
                <li>
                    

<a href="https://www.cnblogs.com/leftJS/p/11099350.html">5.虚拟DOM</a>

                </li>
                <li>
                    

<a href="https://www.cnblogs.com/leftJS/p/11098898.html">6.vue、react、angular三大框架对比 &amp;&amp; 与jQuery的对比</a>

                </li>
                <li>
                    

<a href="https://www.cnblogs.com/leftJS/p/11098020.html">7.DOS、DOS攻击、DDOS攻击、DRDOS攻击</a>

                </li>
                <li>
                    

<a href="https://www.cnblogs.com/leftJS/p/11097802.html">8.Web 安全</a>

                </li>
                <li>
                    

<a href="https://www.cnblogs.com/leftJS/p/11097387.html">9.移动端兼容性问题</a>

                </li>
                <li>
                    

<a href="https://www.cnblogs.com/leftJS/p/11097181.html">10.浏览器兼容性问题</a>

                </li>
			

</ul>
</div>


</div>


<!-- 我的标签 -->
<div id="sidebar_toptags" class="sidebar-block">
    
</div>

<!-- 积分与排名 -->


<!-- 随笔分类、随笔档案、文章分类、新闻分类、相册、链接 -->
<div id="sidebar_categories">
    
        <div id="sidebar_postcategory" class="catListPostCategory sidebar-block">
            <h3 class="catListTitle">
                

随笔分类
<span style="font-size:11px;font-weight:normal">(88)</span>


            </h3>


            <ul>

                        <li>
                            
<a href="https://www.cnblogs.com/leftJS/category/1492675.html" rel="" target="">
    01HTML/CSS(13)
</a>
 

                        </li>
                        <li>
                            
<a href="https://www.cnblogs.com/leftJS/category/1492676.html" rel="" target="">
    02JavaScript(21)
</a>
 

                        </li>
                        <li>
                            
<a href="https://www.cnblogs.com/leftJS/category/1492680.html" rel="" target="">
    03ES6(5)
</a>
 

                        </li>
                        <li>
                            
<a href="https://www.cnblogs.com/leftJS/category/1492695.html" rel="" target="">
    jQuery(2)
</a>
 

                        </li>
                        <li>
                            
<a href="https://www.cnblogs.com/leftJS/category/1492683.html" rel="" target="">
    node.js(1)
</a>
 

                        </li>
                        <li>
                            
<a href="https://www.cnblogs.com/leftJS/category/1491615.html" rel="" target="">
    Vue(7)
</a>
 

                        </li>
                        <li>
                            
<a href="https://www.cnblogs.com/leftJS/category/1491618.html" rel="" target="">
    webpack(1)
</a>
 

                        </li>
                        <li>
                            
<a href="https://www.cnblogs.com/leftJS/category/1491519.html" rel="" target="">
    安全性问题(4)
</a>
 

                        </li>
                        <li>
                            
<a href="https://www.cnblogs.com/leftJS/category/1492700.html" rel="" target="">
    代码规范(2)
</a>
 

                        </li>
                        <li>
                            
<a href="https://www.cnblogs.com/leftJS/category/1491265.html" rel="" target="">
    兼容性问题(3)
</a>
 

                        </li>
                        <li>
                            
<a href="https://www.cnblogs.com/leftJS/category/1387859.html" rel="" target="">
    简历
</a>
 

                        </li>
                        <li>
                            
<a href="https://www.cnblogs.com/leftJS/category/1432954.html" rel="" target="">
    开发经验整理(5)
</a>
 

                        </li>
                        <li>
                            
<a href="https://www.cnblogs.com/leftJS/category/1492684.html" rel="" target="">
    浏览器相关(8)
</a>
 

                        </li>
                        <li>
                            
<a href="https://www.cnblogs.com/leftJS/category/1467367.html" rel="" target="">
    前端面试题(1)
</a>
 

                        </li>
                        <li>
                            
<a href="https://www.cnblogs.com/leftJS/category/1491612.html" rel="" target="">
    算法(4)
</a>
 

                        </li>
                        <li>
                            
<a href="https://www.cnblogs.com/leftJS/category/1387862.html" rel="" target="">
    性能优化(6)
</a>
 

                        </li>
                        <li>
                            
<a href="https://www.cnblogs.com/leftJS/category/1433438.html" rel="" target="">
    学习网站(1)
</a>
 

                        </li>
                        <li>
                            
<a href="https://www.cnblogs.com/leftJS/category/1490164.html" rel="" target="">
    移动端开发(4)
</a>
 

                        </li>

            </ul>


        </div>
        <div id="sidebar_postarchive" class="catListPostArchive sidebar-block">
            <h3 class="catListTitle">
                

随笔档案
<span style="font-size:11px;font-weight:normal">(88)</span>


            </h3>


            <ul>

                        <li>
                            
<a href="https://www.cnblogs.com/leftJS/archive/2019/06.html" rel="" target="">
    2019年6月(58)
</a>
 

                        </li>
                        <li>
                            
<a href="https://www.cnblogs.com/leftJS/archive/2019/05.html" rel="" target="">
    2019年5月(20)
</a>
 

                        </li>
                        <li>
                            
<a href="https://www.cnblogs.com/leftJS/archive/2019/03.html" rel="" target="">
    2019年3月(8)
</a>
 

                        </li>
                        <li>
                            
<a href="https://www.cnblogs.com/leftJS/archive/2019/01.html" rel="" target="">
    2019年1月(2)
</a>
 

                        </li>

            </ul>


        </div>

</div>

<!-- 最新评论 -->
<div id="sidebar_recentcomments" class="sidebar-block">
    
</div>



<!-- 阅读排行榜 -->
<div id="sidebar_topviewedposts" class="sidebar-block">
    <div class="catListView">
<h3 class="catListTitle">阅读排行榜</h3>
	<div id="TopViewPostsBlock">
        <ul style="word-break:break-all">
                    <li>
                        <a href="https://www.cnblogs.com/leftJS/p/11073481.html">
                            1. AMD、CMD规范(1116)
                        </a>
                    </li>
                    <li>
                        <a href="https://www.cnblogs.com/leftJS/p/11082910.html">
                            2. tcp、http和socket的区别(1095)
                        </a>
                    </li>
                    <li>
                        <a href="https://www.cnblogs.com/leftJS/p/11105909.html">
                            3. 项目中遇到哪些难点，如何解决的(1072)
                        </a>
                    </li>
                    <li>
                        <a href="https://www.cnblogs.com/leftJS/p/11095226.html">
                            4. 点击穿透事件原因及解决办法(903)
                        </a>
                    </li>
                    <li>
                        <a href="https://www.cnblogs.com/leftJS/p/11074694.html">
                            5. JS给数字加千位分隔符(792)
                        </a>
                    </li>
        </ul>
    </div>
</div>


</div>

<!-- 评论排行榜 -->
<div id="sidebar_topcommentedposts" class="sidebar-block">
    
</div>

<!-- 推荐排行榜 -->
<div id="sidebar_topdiggedposts" class="sidebar-block">
    
<div id="topdigg_posts_wrap">
    <div class="catListView">
        <h3 class="catListTitle">推荐排行榜</h3>
        <div id="TopDiggPostsBlock">
            <ul style="word-break: break-all">
                        <li>
                            <a href="https://www.cnblogs.com/leftJS/p/10943482.html">
                                1. JS原型、原型链、构造函数、实例与继承(1)
                            </a>
                        </li>
                        <li>
                            <a href="https://www.cnblogs.com/leftJS/p/11041410.html">
                                2. HTML5中的SSE（服务器推送技术）(1)
                            </a>
                        </li>
                        <li>
                            <a href="https://www.cnblogs.com/leftJS/p/11097181.html">
                                3. 浏览器兼容性问题(1)
                            </a>
                        </li>
            </ul>
        </div>
    </div>
</div>
</div></div>
                    <script>loadBlogSideColumn();</script>
			</div>
			
		</div><!--end: sideBarMain -->
	</div><!--end: sideBar 侧边栏容器 -->
	<div class="clear"></div>
	</div><!--end: main -->
	<div class="clear"></div>
	<div id="footer">
		<!--done-->
Copyright © 2019 一粒一世界
<br><span id="poweredby">Powered by .NET Core 3.0.0 on Linux</span>



	</div><!--end: footer -->
</div><!--end: home 自定义的最大容器 -->


    


</body></html>